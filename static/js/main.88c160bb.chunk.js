(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],[,,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var i=n(1),o=n.n(i),r=n(10),c=n.n(r),s=n(4),u=(n(15),n(16),n(17),n(18),Object(i.createContext)({})),a=(n(19),n(20),n(0));function l(t){var e=t.color;return Object(a.jsx)("div",{className:"cell cell--".concat(e)})}function f(t){var e=t.cells;return Object(a.jsx)("div",{className:"row",children:e.map((function(t,e){return Object(a.jsx)("div",{className:"row__cells",children:Object(a.jsx)(l,{color:t})},e)}))})}function h(){var t=Object(i.useContext)(u).gameState;return Object(a.jsx)("div",{className:"board",children:t.rows.map((function(t,e){return Object(a.jsx)("div",{className:"board__row",children:Object(a.jsx)(f,{cells:t})},e)}))})}function j(){return Object(a.jsx)("div",{className:"screenLeft",children:Object(a.jsx)("div",{className:"screenLeft__board",children:Object(a.jsx)(h,{})})})}n(22);function d(){return Object(a.jsxs)("div",{className:"screenRight",children:[Object(a.jsx)("div",{className:"screenRight__afterNext",children:"afterNext"}),Object(a.jsx)("div",{className:"screenRight__hold",children:"hold"})]})}function m(){return Object(a.jsxs)("div",{className:"screen",children:[Object(a.jsx)("div",{className:"screen__left",children:Object(a.jsx)(j,{})}),Object(a.jsx)("div",{className:"screen__right",children:Object(a.jsx)(d,{})})]})}n(23),n(24);function v(){return Object(a.jsxs)("div",{className:"controllerLeft",children:[Object(a.jsx)("p",{children:"pm/am"}),Object(a.jsx)("p",{children:"p/a"})]})}var p;n(25),n(26);!function(t){t[t.Up=0]="Up",t[t.Right=1]="Right",t[t.Down=2]="Down",t[t.Left=3]="Left",t[t.RotationLeft=4]="RotationLeft",t[t.RotationRight=5]="RotationRight"}(p||(p={}));var b=function(t){var e=Object(i.useContext)(u),n=(e.gameState,e.setGameState),o=Object(i.useState)(!1),r=Object(s.a)(o,2),c=r[0],a=r[1],l=Object(i.useRef)(null),f=Object(i.useRef)(null);return Object(i.useEffect)((function(){c?(n(Y.input(t)),f.current=setTimeout((function(){l.current=setInterval((function(){n(Y.input(t))}),120)}),300)):(null!==l&&clearInterval(l.current),null!==f&&clearTimeout(f.current))}),[c]),a},O=function(t){var e=Object(i.useContext)(u),n=(e.gameState,e.setGameState),o=Object(i.useRef)(null),r=Object(i.useRef)(null);return Object(i.useCallback)((function(e){e.addEventListener("touchstart",(function(e){e.preventDefault(),n(Y.input(t)),r.current=setTimeout((function(){o.current=setInterval((function(){n(Y.input(t))}),120)}),300)}),{passive:!1}),e.addEventListener("touchend",(function(t){t.preventDefault(),null!==o&&clearInterval(o.current),null!==r&&clearTimeout(r.current)}),{passive:!1})}),[])},w=n(9);function x(){var t=Object(i.useContext)(u),e=(t.gameState,t.setGameState),n=b(p.Down),o=b(p.Left),r=b(p.Right);return Object(a.jsxs)("div",{className:"crossKeys",children:[Object(a.jsx)("div",{className:"crossKeys__up crossKey",onClick:function(){e(Y.input(p.Up))}}),Object(a.jsx)("div",{className:"crossKeys__left crossKey",onMouseDown:function(){return o(!0)},onMouseUp:function(){return o(!1)}}),Object(a.jsx)("div",{className:"crossKeys__right crossKey",onMouseDown:function(){return r(!0)},onMouseUp:function(){return r(!1)}}),Object(a.jsx)("div",{className:"crossKeys__down crossKey",onMouseDown:function(){return n(!0)},onMouseUp:function(){return n(!1)}})]})}function y(){var t=Object(i.useContext)(u),e=(t.gameState,t.setGameState),n=O(p.Down),o=O(p.Left),r=O(p.Right);return Object(a.jsxs)("div",{className:"crossKeys",children:[Object(a.jsx)("div",{className:"crossKeys__up crossKey",onClick:function(){e(Y.input(p.Up))}}),Object(a.jsx)("div",{className:"crossKeys__left crossKey",ref:o}),Object(a.jsx)("div",{className:"crossKeys__right crossKey",ref:r}),Object(a.jsx)("div",{className:"crossKeys__down crossKey",ref:n})]})}function g(){var t=Object(w.useMediaQuery)({query:"(min-width: 768px)"}),e=Object(w.useMediaQuery)({query:"(max-width: 768px)"});return Object(a.jsxs)(a.Fragment,{children:[t&&Object(a.jsx)(x,{}),e&&Object(a.jsx)(y,{})]})}n(27);function M(){var t=Object(i.useContext)(u),e=(t.gameState,t.setGameState);return Object(a.jsxs)("div",{className:"rotationKeys",children:[Object(a.jsx)("div",{className:"rotationKeys__right",children:Object(a.jsx)("button",{type:"button",onClick:function(){e(Y.input(p.RotationRight))},children:"R"})}),Object(a.jsx)("div",{className:"rotationKeys__left",children:Object(a.jsx)("button",{type:"button",onClick:function(){e(Y.input(p.RotationLeft))},children:"L"})})]})}function R(){return Object(a.jsxs)("div",{className:"controllerRight",children:[Object(a.jsx)("div",{className:"controllerRight__rotationKeys",children:Object(a.jsx)(M,{})}),Object(a.jsx)("div",{className:"controllerRight__crossKeys",children:Object(a.jsx)(g,{})})]})}function _(){return Object(a.jsxs)("div",{className:"controller",children:[Object(a.jsx)("div",{className:"controller__left",children:Object(a.jsx)(v,{})}),Object(a.jsx)("div",{className:"controller__right",children:Object(a.jsx)(R,{})})]})}var N,k=n(2),L=n(3);!function(t){t.None="none",t.LightBlue="lightBlue",t.Yellow="yellow",t.Purple="purple",t.Green="green",t.Red="red",t.Orange="orange",t.Blue="blue"}(N||(N={}));var C,S=function(t){return t[0].map((function(e,n){return t.map((function(t){return t[n]})).reverse()}))},D=function(t){return S(S(t))},K=n(7),A=function(){function t(e){var n=this;Object(k.a)(this,t),this.positions=e,this.rightCol=function(){return Math.max.apply(Math,Object(K.a)(n.positions.map((function(t){return t.col}))))},this.leftCol=function(){return Math.min.apply(Math,Object(K.a)(n.positions.map((function(t){return t.col}))))},this.bottomRow=function(){return Math.max.apply(Math,Object(K.a)(n.positions.map((function(t){return t.row}))))}}return Object(L.a)(t,null,[{key:"fromMatrix",value:function(e){return new t(e.flatMap((function(t,e){return t.map((function(t,n){return{b:t,position:{row:e,col:n}}})).filter((function(t){return t.b}))})).map((function(t){return t.position})))}}]),t}(),B=function(){function t(e,n,i,o){Object(k.a)(this,t),this.a=e,this.b=n,this.c=i,this.d=o}return Object(L.a)(t,null,[{key:"fromMatrix",value:function(e){return new t(A.fromMatrix(e),A.fromMatrix(S(e)),A.fromMatrix(D(e)),A.fromMatrix(D(S(e))))}}]),t}();!function(t){t[t.I=0]="I",t[t.O=1]="O",t[t.T=2]="T",t[t.S=3]="S",t[t.Z=4]="Z",t[t.L=5]="L",t[t.J=6]="J"}(C||(C={}));var E,T={i:B.fromMatrix([[!1,!1,!1,!1],[!0,!0,!0,!0],[!1,!1,!1,!1],[!1,!1,!1,!1]]),o:B.fromMatrix([[!0,!0],[!0,!0]]),t:B.fromMatrix([[!1,!0,!1],[!0,!0,!0],[!1,!1,!1]]),s:B.fromMatrix([[!1,!0,!0],[!0,!0,!1],[!1,!1,!1]]),z:B.fromMatrix([[!0,!0,!1],[!1,!0,!0],[!1,!1,!1]]),l:B.fromMatrix([[!1,!1,!0],[!0,!0,!0],[!1,!1,!1]]),j:B.fromMatrix([[!0,!1,!1],[!0,!0,!0],[!1,!1,!1]])};!function(t){t[t.A=0]="A",t[t.B=1]="B",t[t.C=2]="C",t[t.D=3]="D"}(E||(E={}));var U=function(){function t(e,n,i){Object(k.a)(this,t),this.minoType=e,this.rotation=n,this.color=i}return Object(L.a)(t,[{key:"getShape",value:function(t){if(t===E.A)return this.rotation.a;if(t===E.B)return this.rotation.b;if(t===E.C)return this.rotation.c;if(t===E.D)return this.rotation.d;throw Error("no direction found")}}]),t}(),I={i:function(){return new U(C.I,T.i,N.LightBlue)},o:function(){return new U(C.O,T.o,N.Yellow)},t:function(){return new U(C.T,T.t,N.Purple)},s:function(){return new U(C.S,T.s,N.Green)},z:function(){return new U(C.Z,T.z,N.Red)},l:function(){return new U(C.L,T.l,N.Orange)},j:function(){return new U(C.J,T.j,N.Blue)},random:function(){var t;switch(t=7,Math.floor(Math.random()*t)){case 0:return this.i();case 1:return this.o();case 2:return this.t();case 3:return this.s();case 4:return this.z();case 5:return this.l();case 6:return this.j();default:throw Error("failed to create random mino")}}},G=function(){function t(e,n,i){Object(k.a)(this,t),this.mino=e,this.position=n,this.direction=i}return Object(L.a)(t,[{key:"getShape",value:function(){return this.mino.getShape(this.direction)}},{key:"rotationRight",value:function(){if(this.direction===E.A)return new t(this.mino,this.position,E.B);if(this.direction===E.B)return new t(this.mino,this.position,E.C);if(this.direction===E.C)return new t(this.mino,this.position,E.D);if(this.direction===E.D)return new t(this.mino,this.position,E.A);throw Error("invalid direction found: "+this.direction)}},{key:"rotationLeft",value:function(){if(this.direction===E.A)return new t(this.mino,this.position,E.D);if(this.direction===E.B)return new t(this.mino,this.position,E.A);if(this.direction===E.C)return new t(this.mino,this.position,E.B);if(this.direction===E.D)return new t(this.mino,this.position,E.C);throw Error("invalid direction found: "+this.direction)}},{key:"moveRight",value:function(){return this.move({row:this.position.row,col:this.position.col+1})}},{key:"moveLeft",value:function(){return this.move({row:this.position.row,col:this.position.col-1})}},{key:"moveDown",value:function(){return this.move({row:this.position.row+1,col:this.position.col})}},{key:"move",value:function(e){return new t(this.mino,e,this.direction)}},{key:"rightCol",value:function(){return this.position.col+this.getShape().rightCol()}},{key:"leftCol",value:function(){return this.position.col+this.getShape().leftCol()}},{key:"bottomRow",value:function(){return this.position.row+this.getShape().bottomRow()}}]),t}(),z=function(){function t(e,n){Object(k.a)(this,t),this.currentMino=e,this.rows=n}return Object(L.a)(t,[{key:"state",get:function(){var t=this,e=this.rows.map((function(t){return t.map((function(t){return t}))}));return this.currentMino.getShape().positions.forEach((function(n){e[t.currentMino.position.row+n.row][t.currentMino.position.col+n.col]=t.currentMino.mino.color})),{rows:e}}},{key:"input",value:function(t){return t===p.Up?(this.drop(),this.rows=this.state.rows,this.currentMino=new G(I.random(),{row:0,col:3},E.A)):t===p.Right?this.moveRight():t===p.Down?this.moveDown():t===p.Left?this.moveLeft():t===p.RotationLeft?this.currentMino=this.currentMino.rotationLeft():t===p.RotationRight&&(this.currentMino=this.currentMino.rotationRight()),this.state}},{key:"moveRight",value:function(){var e=this.currentMino.moveRight();e.rightCol()>=t.ncol||this.collided(e)||(this.currentMino=e)}},{key:"moveLeft",value:function(){var t=this.currentMino.moveLeft();t.leftCol()<0||this.collided(t)||(this.currentMino=t)}},{key:"moveDown",value:function(){var e=this.currentMino.moveDown();e.bottomRow()>=t.nrow||this.collided(e)||(this.currentMino=e)}},{key:"drop",value:function(){for(;;){var e=this.currentMino.moveDown();if(e.bottomRow()>=t.nrow)break;if(this.collided(e))break;this.currentMino=e}}},{key:"collided",value:function(t){var e=this;return void 0!==t.getShape().positions.map((function(e){return{row:e.row+t.position.row,col:e.col+t.position.col}})).find((function(t){return e.rows[t.row][t.col]!==N.None}))}}],[{key:"create",value:function(){var e=this,n=Array(this.nrow).fill(0).map((function(t){return Array(e.ncol).fill(N.None)}));return new t(new G(I.j(),{row:0,col:3},E.A),n)}}]),t}();z.ncol=10,z.nrow=20;var F="ArrowDown",J="ArrowUp",P="ArrowRight",Z="ArrowLeft",q="z",Q="x",Y=z.create();var H=function(){var t,e=Object(i.useState)(Y.state),n=Object(s.a)(e,2),o=n[0],r=n[1];return t=[{key:F,f:function(){r(Y.input(p.Down))}},{key:J,f:function(){r(Y.input(p.Up))}},{key:P,f:function(){r(Y.input(p.Right))}},{key:Z,f:function(){r(Y.input(p.Left))}},{key:q,f:function(){r(Y.input(p.RotationLeft))}},{key:Q,f:function(){r(Y.input(p.RotationRight))}}],Object(i.useEffect)((function(){document.addEventListener("keydown",(function(e){var n=t.find((function(t){return t.key===e.key}));n&&n.f()}),!1)}),[]),Object(a.jsx)(u.Provider,{value:{gameState:o,setGameState:r},children:Object(a.jsxs)("div",{className:"app",children:[Object(a.jsx)("div",{className:"app__screen",children:Object(a.jsx)(m,{})}),Object(a.jsx)("div",{className:"app_controller",children:Object(a.jsx)(_,{})})]})})},V=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,29)).then((function(e){var n=e.getCLS,i=e.getFID,o=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),i(t),o(t),r(t),c(t)}))};c.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(H,{})}),document.getElementById("root")),V()}],[[28,1,2]]]);
//# sourceMappingURL=main.88c160bb.chunk.js.map