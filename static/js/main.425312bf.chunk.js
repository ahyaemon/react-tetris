(this["webpackJsonpreact-tetris"]=this["webpackJsonpreact-tetris"]||[]).push([[0],{32:function(t,n,e){},37:function(t,n,e){},38:function(t,n,e){},39:function(t,n,e){"use strict";e.r(n);var o,i=e(0),r=e.n(i),c=e(19),u=e.n(c);!function(t){t[t.Up=0]="Up",t[t.Right=1]="Right",t[t.Down=2]="Down",t[t.Left=3]="Left",t[t.RotationLeft=4]="RotationLeft",t[t.RotationRight=5]="RotationRight"}(o||(o={}));var s=e(14),a=(e(32),e(1));function l(t){var n=t.color;return Object(a.jsx)("div",{className:"cell cell--".concat(n)})}var f,h=e(5),d=e(8),p=e(3),w=e(6);function v(t){return!t.includes(f.None)}!function(t){t.None="none",t.LightBlue="lightBlue",t.Yellow="yellow",t.Purple="purple",t.Green="green",t.Red="red",t.Orange="orange",t.Blue="blue",t.LightBlueGhost="lightBlue--ghost",t.YellowGhost="yellow--ghost",t.PurpleGhost="purple--ghost",t.GreenGhost="green--ghost",t.RedGhost="red--ghost",t.OrangeGhost="orange--ghost",t.BlueGhost="blue--ghost"}(f||(f={}));var b,j=function(t){return t[0].map((function(n,e){return t.map((function(t){return t[e]})).reverse()}))},m=function(t){return j(j(t))},O=function(){function t(n){var e=this;Object(p.a)(this,t),this.positions=n,this.rightCol=function(){return Math.max.apply(Math,Object(d.a)(e.positions.map((function(t){return t.col}))))},this.leftCol=function(){return Math.min.apply(Math,Object(d.a)(e.positions.map((function(t){return t.col}))))},this.bottomRow=function(){return Math.max.apply(Math,Object(d.a)(e.positions.map((function(t){return t.row}))))}}return Object(w.a)(t,null,[{key:"fromMatrix",value:function(n){return new t(n.flatMap((function(t,n){return t.map((function(t,e){return{b:t,position:{row:n,col:e}}})).filter((function(t){return t.b}))})).map((function(t){return t.position})))}}]),t}(),y=function(){function t(n,e,o,i){Object(p.a)(this,t),this.a=n,this.b=e,this.c=o,this.d=i}return Object(w.a)(t,null,[{key:"fromMatrix",value:function(n){return new t(O.fromMatrix(n),O.fromMatrix(j(n)),O.fromMatrix(m(n)),O.fromMatrix(m(j(n))))}}]),t}();!function(t){t[t.I=0]="I",t[t.O=1]="O",t[t.T=2]="T",t[t.S=3]="S",t[t.Z=4]="Z",t[t.L=5]="L",t[t.J=6]="J"}(b||(b={}));var g,M={i:y.fromMatrix([[!1,!1,!1,!1],[!0,!0,!0,!0],[!1,!1,!1,!1],[!1,!1,!1,!1]]),o:y.fromMatrix([[!0,!0],[!0,!0]]),t:y.fromMatrix([[!1,!0,!1],[!0,!0,!0],[!1,!1,!1]]),s:y.fromMatrix([[!1,!0,!0],[!0,!0,!1],[!1,!1,!1]]),z:y.fromMatrix([[!0,!0,!1],[!1,!0,!0],[!1,!1,!1]]),l:y.fromMatrix([[!1,!1,!0],[!0,!0,!0],[!1,!1,!1]]),j:y.fromMatrix([[!0,!1,!1],[!0,!0,!0],[!1,!1,!1]])};!function(t){t[t.A=0]="A",t[t.B=1]="B",t[t.C=2]="C",t[t.D=3]="D"}(g||(g={}));var k=function(){function t(n,e,o){Object(p.a)(this,t),this.minoType=n,this.rotation=e,this.color=o}return Object(w.a)(t,[{key:"getShape",value:function(t){if(t===g.A)return this.rotation.a;if(t===g.B)return this.rotation.b;if(t===g.C)return this.rotation.c;if(t===g.D)return this.rotation.d;throw Error("no direction found")}}]),t}(),x={i:function(){return new k(b.I,M.i,f.LightBlue)},o:function(){return new k(b.O,M.o,f.Yellow)},t:function(){return new k(b.T,M.t,f.Purple)},s:function(){return new k(b.S,M.s,f.Green)},z:function(){return new k(b.Z,M.z,f.Red)},l:function(){return new k(b.L,M.l,f.Orange)},j:function(){return new k(b.J,M.j,f.Blue)},random:function(){var t;switch(t=7,Math.floor(Math.random()*t)){case 0:return this.i();case 1:return this.o();case 2:return this.t();case 3:return this.s();case 4:return this.z();case 5:return this.l();case 6:return this.j();default:throw Error("failed to create random mino")}}},R=function(){function t(n,e,o){Object(p.a)(this,t),this.mino=n,this.position=e,this.direction=o}return Object(w.a)(t,[{key:"copy",value:function(){return new t(this.mino,{row:this.position.row,col:this.position.col},this.direction)}},{key:"getShape",value:function(){return this.mino.getShape(this.direction)}},{key:"rotationRight",value:function(){if(this.direction===g.A)return new t(this.mino,this.position,g.B);if(this.direction===g.B)return new t(this.mino,this.position,g.C);if(this.direction===g.C)return new t(this.mino,this.position,g.D);if(this.direction===g.D)return new t(this.mino,this.position,g.A);throw Error("invalid direction found: "+this.direction)}},{key:"rotationLeft",value:function(){if(this.direction===g.A)return new t(this.mino,this.position,g.D);if(this.direction===g.B)return new t(this.mino,this.position,g.A);if(this.direction===g.C)return new t(this.mino,this.position,g.B);if(this.direction===g.D)return new t(this.mino,this.position,g.C);throw Error("invalid direction found: "+this.direction)}},{key:"moveRight",value:function(){return this.move({row:this.position.row,col:this.position.col+1})}},{key:"moveLeft",value:function(){return this.move({row:this.position.row,col:this.position.col-1})}},{key:"moveDown",value:function(){return this.move({row:this.position.row+1,col:this.position.col})}},{key:"move",value:function(n){return new t(this.mino,n,this.direction)}},{key:"rightCol",value:function(){return this.position.col+this.getShape().rightCol()}},{key:"leftCol",value:function(){return this.position.col+this.getShape().leftCol()}},{key:"bottomRow",value:function(){return this.position.row+this.getShape().bottomRow()}},{key:"cellPositions",value:function(){var t=this;return this.getShape().positions.map((function(n){return{row:n.row+t.position.row,col:n.col+t.position.col}}))}},{key:"collided",value:function(t){return void 0!==this.cellPositions().find((function(n){return t[n.row][n.col]!==f.None}))}}]),t}(),L=function(){function t(n,e){Object(p.a)(this,t),this.currentMino=n,this.rows=e}return Object(w.a)(t,[{key:"state",get:function(){var t=this,n=this.rows.map((function(t){return t.map((function(t){return t}))})),e=this.drop();return e.getShape().positions.forEach((function(o){var i;n[e.position.row+o.row][e.position.col+o.col]=(i=t.currentMino.mino.color)===f.LightBlue?f.LightBlueGhost:i===f.Yellow?f.YellowGhost:i===f.Purple?f.PurpleGhost:i===f.Green?f.GreenGhost:i===f.Red?f.RedGhost:i===f.Orange?f.OrangeGhost:i===f.Blue?f.BlueGhost:f.None})),this.currentMino.getShape().positions.forEach((function(e){n[t.currentMino.position.row+e.row][t.currentMino.position.col+e.col]=t.currentMino.mino.color})),{rows:n}}},{key:"input",value:function(n){if(n===o.Up){var e=new t(this.drop(),this.rows).state.rows,i=this.clearRows(e,t.ncol);return new t(new R(x.random(),{row:0,col:3},g.A),i)}if(n===o.Right)return new t(this.moveRight(),this.rows);if(n===o.Down)return new t(this.moveDown(),this.rows);if(n===o.Left)return new t(this.moveLeft(),this.rows);if(n===o.RotationLeft)return new t(this.currentMino.rotationLeft(),this.rows);if(n===o.RotationRight)return new t(this.currentMino.rotationRight(),this.rows);throw Error("no command found")}},{key:"moveRight",value:function(){var n=this.currentMino.moveRight();return n.rightCol()>=t.ncol||n.collided(this.rows)?this.currentMino:n}},{key:"moveLeft",value:function(){var t=this.currentMino.moveLeft();return t.leftCol()<0||t.collided(this.rows)?this.currentMino:t}},{key:"moveDown",value:function(){var n=this.currentMino.moveDown();return n.bottomRow()>=t.nrow||n.collided(this.rows)?this.currentMino:n}},{key:"drop",value:function(){for(var n=this.currentMino.copy();;){var e=n.moveDown();if(e.bottomRow()>=t.nrow)break;if(e.collided(this.rows))break;n=e}return n}},{key:"clearRows",value:function(t,n){var e=t.filter((function(t){return v(t)})).length;if(0===e)return t;var o=t.filter((function(t){return!v(t)})),i=Array(e).fill(0).map((function(t){return function(t){return Array(t).fill(f.None)}(n)}));return[].concat(Object(d.a)(i),Object(d.a)(o))}}],[{key:"create",value:function(){var n=this,e=Array(this.nrow).fill(0).map((function(t){return Array(n.ncol).fill(f.None)}));return new t(new R(x.j(),{row:0,col:3},g.A),e)}}]),t}();L.ncol=10,L.nrow=20;var D=Object(h.b)({key:"game",default:L.create()}),C=Object(h.c)({key:"board",get:function(t){return(0,t.get)(D).state}}),K=e(7),_={board:Object(s.a)({border:"1px solid grey",display:"inline-block"}),row:Object(s.a)({display:"flex"})};function B(){var t=Object(h.d)(C);return Object(K.a)("div",{css:_.board,children:t.rows.map((function(t,n){return Object(K.a)("div",{css:_.row,children:t.map((function(t,n){return Object(K.a)("div",{className:"row__cells",children:Object(K.a)(l,{color:t})},n)}))},n)}))})}e(37);function N(){var t=Object(h.e)(D);return Object(a.jsxs)("div",{className:"rotationKeys",children:[Object(a.jsx)("div",{className:"rotationKeys__right",children:Object(a.jsx)("button",{type:"button",onClick:function(){t((function(t){return t.input(o.RotationRight)}))},children:"R"})}),Object(a.jsx)("div",{className:"rotationKeys__left",children:Object(a.jsx)("button",{type:"button",onClick:function(){t((function(t){return t.input(o.RotationLeft)}))},children:"L"})})]})}e(38);var G=e(2),A=function(t){var n=Object(h.e)(D),e=Object(i.useState)(!1),o=Object(G.a)(e,2),r=o[0],c=o[1],u=Object(i.useRef)(null),s=Object(i.useRef)(null);return Object(i.useEffect)((function(){r?(n((function(n){return n.input(t)})),s.current=setTimeout((function(){u.current=setInterval((function(){n((function(n){return n.input(t)}))}),120)}),300)):(null!==u&&clearInterval(u.current),null!==s&&clearTimeout(s.current))}),[r]),c},S=function(t){var n=Object(h.e)(D),e=Object(i.useRef)(null),o=Object(i.useRef)(null);return Object(i.useCallback)((function(i){i.addEventListener("touchstart",(function(i){i.preventDefault(),n((function(n){return n.input(t)})),o.current=setTimeout((function(){e.current=setInterval((function(){n((function(n){return n.input(t)}))}),120)}),300)}),{passive:!1}),i.addEventListener("touchend",(function(t){t.preventDefault(),null!==e&&clearInterval(e.current),null!==o&&clearTimeout(o.current)}),{passive:!1})}),[])},E=e(26);function T(){var t=Object(h.e)(D),n=A(o.Down),e=A(o.Left),i=A(o.Right);return Object(a.jsxs)("div",{className:"crossKeys",children:[Object(a.jsx)("div",{className:"crossKeys__up crossKey",onClick:function(){t((function(t){return t.input(o.Up)}))}}),Object(a.jsx)("div",{className:"crossKeys__left crossKey",onMouseDown:function(){return e(!0)},onMouseUp:function(){return e(!1)}}),Object(a.jsx)("div",{className:"crossKeys__right crossKey",onMouseDown:function(){return i(!0)},onMouseUp:function(){return i(!1)}}),Object(a.jsx)("div",{className:"crossKeys__down crossKey",onMouseDown:function(){return n(!0)},onMouseUp:function(){return n(!1)}})]})}function U(){var t=Object(h.e)(D),n=S(o.Down),e=S(o.Left),i=S(o.Right);return Object(a.jsxs)("div",{className:"crossKeys",children:[Object(a.jsx)("div",{className:"crossKeys__up crossKey",onClick:function(){t((function(t){return t.input(o.Up)}))}}),Object(a.jsx)("div",{className:"crossKeys__left crossKey",ref:e}),Object(a.jsx)("div",{className:"crossKeys__right crossKey",ref:i}),Object(a.jsx)("div",{className:"crossKeys__down crossKey",ref:n})]})}function I(){var t=Object(E.useMediaQuery)({query:"(min-width: 768px)"}),n=Object(E.useMediaQuery)({query:"(max-width: 768px)"});return Object(a.jsxs)(a.Fragment,{children:[t&&Object(a.jsx)(T,{}),n&&Object(a.jsx)(U,{})]})}var P={controller:Object(s.a)({display:"flex"}),crossKeys:Object(s.a)({width:1200})};function z(){return Object(K.b)("div",{children:[Object(K.a)("div",{children:Object(K.a)(B,{})}),Object(K.b)("div",{css:P.controller,children:[Object(K.a)("div",{children:Object(K.a)(I,{})}),Object(K.a)("div",{children:Object(K.a)(N,{})})]})]})}var F="ArrowDown",J="ArrowUp",Y="ArrowRight",Z="ArrowLeft",q="z",Q="x";var H=function(){var t,n=Object(h.e)(D);return t=[{key:F,f:function(){n((function(t){return t.input(o.Down)}))}},{key:J,f:function(){n((function(t){return t.input(o.Up)}))}},{key:Y,f:function(){n((function(t){return t.input(o.Right)}))}},{key:Z,f:function(){n((function(t){return t.input(o.Left)}))}},{key:q,f:function(){n((function(t){return t.input(o.RotationLeft)}))}},{key:Q,f:function(){n((function(t){return t.input(o.RotationRight)}))}}],Object(i.useEffect)((function(){document.addEventListener("keydown",(function(n){var e=t.find((function(t){return t.key===n.key}));e&&e.f()}),!1)}),[]),Object(a.jsx)(z,{})},V=function(t){t&&t instanceof Function&&e.e(3).then(e.bind(null,40)).then((function(n){var e=n.getCLS,o=n.getFID,i=n.getFCP,r=n.getLCP,c=n.getTTFB;e(t),o(t),i(t),r(t),c(t)}))};u.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(h.a,{children:Object(a.jsx)(H,{})})}),document.getElementById("root")),V()}},[[39,1,2]]]);
//# sourceMappingURL=main.425312bf.chunk.js.map